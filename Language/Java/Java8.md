#Lambda Architecture

## 람다 아키텍쳐란
람다 아키텍쳐는 트위터에서 스트리밍 컴퓨팅에 있었던 Nathan Marz에 의해서 소개된 아키텍쳐로, 실시간 분석을 지원하는 빅데이터 아키텍처이다.
아키텍처에 대한 자세한 내용은 [여기](http://lambda-architecture.net/)에 소개되어 있다.

쉽게 말하면, 대용량의 데이터의 통계값을 조회하고 싶지만
데이터의 건수가 많아 SQL을 통해 처리가 불가능하다.
그럼 일 배치를 통해서 전일 데이터까지의 값과 오늘 하루의 데이터만을 JOIN 하여 결과값을 보면 되지 않을까?
이렇게 매일 배치를 돌리고 오늘의 데이터를 추가로 SQL을 통해 데이터를 추출한 뒤 조인을 하면 원하는 결과값을 얻을 수 있다.

이 개념을 람다 아키텍처로 해석해보면 다음과 같다.

![람다 아키텍처의 개념](http://cfile26.uf.tistory.com/image/2220AA3754AA96321C34B5)

먼저 배치 처리를 위해서 로그 서버는 모든 로그 데이터를 저장소에 저장하고, 배치 처리 계층에서 daily 또는 일정한 시간을 주기로
배치 처리로 계산을 해서 배치 View(table)를 만든다.
그리고 다른 흐름으로 실시간 처리쪽에 데이터를 전송해서 실시간 집계를 해서 실시간 집계 테이블을 만든다.
마지막으로 이 2개의 view를 합쳐서 통계값을 구한다.

`배치 View`는 배치로 돌 때에만 Write가 가능하고 평상 시에는 Read만 가능하다.
이를 통해 데이터의 변형(Corrupt) 를 막을 수 있다.
`실시간 View`는 실시간으로 데이터를 Write하고 Read할 수 있는 시스템을 사용한다.

---
Bigdata의 Hadoop 및 eco system에 대한 mapping을 입력하면 다음과 같다.

![람다 아키텍처에 대한 솔루션 맵핑](http://cfile26.uf.tistory.com/image/242E9F3754AA96320436D8)

저장소는 대량의 데이터를 저비용으로, 안정성 있게 저장할 수 있는 것이 필요하다.
그리고 이런 대량의 데이터를 배치 처리할 때 되도록이면 빠른 시간 내에 복잡한 알고리즘을 적용해서 계산할 수 있는 계층이 필요한데,
이러한 솔루션으로 제시되는 솔루션이 하둡의 HDFS와 MR이다.
이렇게 계산된 배치 데이터를 저장할 장소로는 고속 Access가 가능한 HBase라는 NoSQL을 제공한다.

실시간 처리는 복잡한 알고리즘을 빠르게 데이터를 처리할 수 있는 솔루션이 필요한데, 대표적으로 Storm 등이 있으며,
빠른 읽기와 쓰기를 지원해야 하기 때문에 Redis와 같은 In-Memory 기반의 NoSQL이 적절하게 추천되고 있다.

---
계층별로 추상화된 람다 아키텍처는 다음과 같다.

![계층별로 추상화 된 람다 아키텍처](http://cfile29.uf.tistory.com/image/2516723754AA96312EF8D6)

#### 배치 레이어의 의미
배치 레이어의 저장소에는 가공 전의 원본 데이터를 모두 저장한다.
데이터가 전처리된 이후에도 저장소에 데이터를 삭제하지 않는다.
이렇게 원본 데이터를 저장함으로써, 배치 뷰의 데이터가 잘못 계산되었거나, 유실되었을 때, 복구가 가능하고 현재 데이터 분석에서 없었던
새로운 View를 제공하고자 할 때 원본 데이터를 가지고 있음으로써
기존 데이터에 대한 새로운 View를 제공 가능하다.
